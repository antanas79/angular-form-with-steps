<form [formGroup]="stepsForm" class="mt-3">
	<mat-horizontal-stepper
		labelPosition="bottom"
		formArrayName="steps"
		[linear]="isLinear"
	>
		<mat-step [editable]="false">
			<ng-template class="mt-3" matStepLabel>Intro</ng-template>
			<app-intro
				[text]="'Press next to start applying for a loan.'"
			></app-intro>
			<button mat-button matStepperNext type="button" class="next">
				Next
			</button>
		</mat-step>
		<ng-container *ngFor="let step of steps; let i = index;">
			<mat-step
				[editable]="step.isEditable"
				class="mt-3"
				[formGroupName]="i"
				[stepControl]="stepsForm.get('steps')?.get([i])"
			>
				<ng-template class="mt-3" matStepLabel
					>{{step.label}}</ng-template
				>
				<ng-container
					*ngFor="let question of step.questions, let j=index;"
				>
					<mat-form-field class="mr-3 mt-3">
						<div [ngSwitch]="question.controlType">
							<input
								placeholder="{{question.placeholder}}"
								matInput
								*ngSwitchCase="'textbox'"
								[formControlName]="question.key"
								[id]="question.key"
								[type]="question.type"
							/>
							<mat-select
								placeholder="{{question.placeholder}}"
								matInput
								[id]="question.key"
								*ngSwitchCase="'dropdown'"
								[formControlName]="question.key"
								[value]="question.value"
							>
								<mat-option
									*ngFor="let opt of question.options"
									[value]="opt.value"
									>{{opt.label}}</mat-option
								>
							</mat-select>
						</div>
						<mat-error
							><span class="text-capitalize"
								>{{question.label}}</span
							>
							is invalid!</mat-error
						>
					</mat-form-field>
				</ng-container>
				<br />
				<div>
					<button mat-button matStepperPrevious type="button">
						Back
					</button>
					<button
						mat-button
						matStepperNext
						type="button"
						class="next"
					>
						Next
					</button>
				</div>
			</mat-step>
		</ng-container>
		<mat-step [editable]="true">
			<ng-template class="mt-3" matStepLabel>Summary</ng-template>
			<app-summary
				[isEmail]="stepsForm.get('steps').value[1].contactMethod == 2"
				[text]="'Please review entered information below before submitting the form.'"
				[data]="stepsForm.get('steps').value"
			></app-summary>
			<button mat-button matStepperPrevious type="button">Back</button>
			<button mat-button type="button">Submit</button>
		</mat-step>
	</mat-horizontal-stepper>
</form>
